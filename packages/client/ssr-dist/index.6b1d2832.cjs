"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("./ssr.ce1b3cd0.cjs"),v=require("./Icon.f719b880.cjs"),_=require("./Input.2441fc34.cjs"),d=require("./Validate.d56822c5.cjs"),F="_dialog_1agdg_13",P={dialog:F},C=async(t,u)=>{let n=null,a=0;for(;n===null&&a<u.length;){const s=await u[a](t);s&&(n=s),a++}return n},g=t=>{const{rules:u,name:n,value:a=""}=t,[s,o]=e.reactExports.useState(a),[i,l]=e.reactExports.useState(null),c=e.reactExports.useCallback(async r=>{t.onChange&&t.onChange(r);const{value:E}=r.target;o(E),l(await C(E,u))},[t,u]),x=e.reactExports.useCallback(async r=>{t.onBlur&&t.onBlur(r),l(await C(s,u))},[t,u,s]),m=e.reactExports.useCallback(async()=>{const r=await C(s,u);return l(r),!r},[s,u]);return{fieldProps:{type:"text",onChange:c,onBlur:x,name:n,value:s},isValid:m,value:s,error:i}},k=t=>{const{rules:u,name:n,value:a=null}=t,[s,o]=e.reactExports.useState(a),[i,l]=e.reactExports.useState(null),c=e.reactExports.useCallback(async r=>{var h;t.onChange&&t.onChange(r);const{files:E}=r.target,p=(h=E==null?void 0:E.item(0))!=null?h:null;o(p),l(await C(p,u))},[t,u]),x=e.reactExports.useCallback(async r=>{t.onBlur&&t.onBlur(r),l(await C(s,u))},[t,u,s]),m=e.reactExports.useCallback(async()=>{const r=await C(s,u);return l(r),!r},[s,u]);return{fieldProps:{type:"file",onChange:c,onBlur:x,name:n},isValid:m,value:s,error:i}},y=({fields:t,onSubmit:u})=>{const[n,a]=e.reactExports.useState(!1),s=e.reactExports.useCallback(async o=>{if(o.preventDefault(),(await Promise.all(t.map(l=>l.isValid()))).every(l=>l)){a(!0);try{await u(),a(!1)}catch(l){throw a(!1),l}}},[t,u]);return{isSubmitting:n,formProps:{onSubmit:s}}},D=({isOpen:t,onSubmit:u,onOpenChange:n})=>{const a=k({name:"file",rules:[i=>i?null:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u0439\u043B"]}),{isSubmitting:s,formProps:o}=y({fields:[a],onSubmit:async()=>{!a.value||await u({file:a.value})}});return e.jsx(v.Dialog,{title:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:t,onOpenChange:n,contentClass:P.dialog,children:e.jsxs("form",{...o,children:[e.jsx(_.Input,{...a.fieldProps,errorText:a.error,labelText:"\u041D\u043E\u0432\u044B\u0439 \u0430\u0432\u0430\u0442\u0430\u0440"}),e.jsx(e.Button,{type:"submit",loading:s,disabled:s,children:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C"})]})})},O="_dialog_1agdg_13",A={dialog:O},T=({isOpen:t,onSubmit:u,onOpenChange:n})=>{const a=g({value:"",name:"oldPassword",rules:[]}),s=g({value:"",name:"newPassword",rules:[c=>d.validate.password(c||"")?null:d.validate.errorMessages.password]}),o=g({value:"",name:"repeatPassword",rules:[c=>s.value===c?null:"\u041F\u0430\u0440\u043E\u043B\u0438 \u0434\u043E\u043B\u0436\u043D\u044B \u0441\u043E\u0432\u043F\u0430\u0434\u0430\u0442\u044C"]}),{isSubmitting:i,formProps:l}=y({fields:[a,s,o],onSubmit:async()=>{await u({oldPassword:a.value,newPassword:s.value})}});return e.jsx(v.Dialog,{title:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043F\u0430\u0440\u043E\u043B\u044C",isOpen:t,onOpenChange:n,contentClass:A.dialog,children:e.jsxs("form",{...l,children:[e.jsx(_.Input,{...a.fieldProps,errorText:a.error,labelText:"\u0421\u0442\u0430\u0440\u044B\u0439 \u043F\u0430\u0440\u043E\u043B\u044C",type:"password"}),e.jsx(_.Input,{...s.fieldProps,labelText:"\u041D\u043E\u0432\u044B\u0439 \u043F\u0430\u0440\u043E\u043B\u044C",errorText:s.error,type:"password"}),e.jsx(_.Input,{...o.fieldProps,labelText:"\u041F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u0435 \u043F\u0430\u0440\u043E\u043B\u044C",errorText:o.error,type:"password"}),e.jsx(e.Button,{type:"submit",loading:i,disabled:i,children:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C"})]})})},N="_spinner_14ayt_13",U="_dialog_14ayt_20",$={spinner:N,dialog:U},M=({viewer:t,isOpen:u,onSubmit:n,onOpenChange:a})=>{const s=g({value:t.email||"",name:"email",rules:[r=>d.validate.email(r||"")?null:d.validate.errorMessages.email]}),o=g({value:t.login||"",name:"login",rules:[r=>d.validate.login(r||"")?null:d.validate.errorMessages.login]}),i=g({value:t.first_name||"",name:"first_name",rules:[r=>d.validate.name(r||"")?null:d.validate.errorMessages.name]}),l=g({value:t.second_name||"",name:"second_name",rules:[r=>d.validate.name(r||"")?null:d.validate.errorMessages.name]}),c=g({value:t.phone||"",name:"phone",rules:[r=>d.validate.phone(r||"")?null:d.validate.errorMessages.phone]}),{formProps:x,isSubmitting:m}=y({fields:[s,o,i,l,c],onSubmit:async()=>{await n({login:o.value,email:s.value,first_name:i.value,second_name:l.value,display_name:t.display_name||"",phone:c.value})}});return e.jsx(v.Dialog,{title:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435",isOpen:u,onOpenChange:a,contentClass:$.dialog,children:e.jsxs("form",{...x,children:[e.jsx(_.Input,{...s.fieldProps,errorText:s.error,labelText:"E-mail"}),e.jsx(_.Input,{...o.fieldProps,labelText:"\u041B\u043E\u0433\u0438\u043D",errorText:o.error}),e.jsx(_.Input,{...i.fieldProps,labelText:"\u0418\u043C\u044F",errorText:i.error}),e.jsx(_.Input,{...l.fieldProps,labelText:"\u0424\u0430\u043C\u0438\u043B\u0438\u044F",errorText:l.error}),e.jsx(_.Input,{...c.fieldProps,labelText:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D",errorText:c.error}),e.jsx(e.Button,{type:"submit",loading:m,disabled:m,children:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C"})]})})},V="_list_e49rv_13",z="_listItem_e49rv_19",R="_linkItem_e49rv_20",q="_listItem__title_e49rv_30",G="_listItem__value_e49rv_34",b={list:V,listItem:z,linkItem:R,listItem__title:q,listItem__value:G},H=({email:t,login:u,first_name:n,second_name:a,phone:s})=>{const o=e.reactExports.useMemo(()=>[{title:"\u041F\u043E\u0447\u0442\u0430",value:t},{title:"\u041B\u043E\u0433\u0438\u043D",value:u},{title:"\u0418\u043C\u044F",value:n},{title:"\u0424\u0430\u043C\u0438\u043B\u0438\u044F",value:a},{title:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D",value:s}],[t,u,n,a,s]);return e.jsx("ul",{className:b.list,children:o.map(({title:i,value:l})=>e.jsxs("li",{className:b.listItem,children:[e.jsx("div",{className:b.listItem__title,children:i}),e.jsx("div",{className:b.listItem__value,children:l})]},i))})},L=t=>`${e.RESOURCES_URL}/${t}`,Z=t=>e.reactExports.createElement("svg",{width:54,height:71,viewBox:"0 0 54 71",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},e.reactExports.createElement("g",{filter:"url(#filter0_b_273_3585)"},e.reactExports.createElement("path",{d:"M27 1.00002C18.2555 1.00002 11.1666 8.08884 11.1666 16.8333C11.1666 25.5779 18.2555 32.6667 27 32.6667C35.7445 32.6667 42.8333 25.5779 42.8333 16.8333C42.8333 8.08884 35.7445 1.00002 27 1.00002Z",fill:"#29ACD6",fillOpacity:.35}),e.reactExports.createElement("path",{d:"M17 37.6667C8.25545 37.6667 1.16663 44.7555 1.16663 53.5C1.16663 62.2445 8.25545 69.3334 17 69.3334H37C45.7445 69.3334 52.8333 62.2445 52.8333 53.5C52.8333 44.7555 45.7445 37.6667 37 37.6667H17Z",fill:"#29ACD6",fillOpacity:.35}),e.reactExports.createElement("path",{d:"M27 0.500015C17.9793 0.500015 10.6666 7.8127 10.6666 16.8333C10.6666 25.854 17.9793 33.1667 27 33.1667C36.0206 33.1667 43.3333 25.854 43.3333 16.8333C43.3333 7.8127 36.0206 0.500015 27 0.500015ZM17 37.1667C7.97931 37.1667 0.666626 44.4794 0.666626 53.5C0.666626 62.5207 7.97931 69.8334 17 69.8334H37C46.0206 69.8334 53.3333 62.5207 53.3333 53.5C53.3333 44.4794 46.0206 37.1667 37 37.1667H17Z",stroke:"url(#paint0_linear_273_3585)",strokeLinecap:"round"})),e.reactExports.createElement("defs",null,e.reactExports.createElement("filter",{id:"filter0_b_273_3585",x:-23.8334,y:-24,width:101.667,height:118.333,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},e.reactExports.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),e.reactExports.createElement("feGaussianBlur",{in:"BackgroundImageFix",stdDeviation:12}),e.reactExports.createElement("feComposite",{in2:"SourceAlpha",operator:"in",result:"effect1_backgroundBlur_273_3585"}),e.reactExports.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_backgroundBlur_273_3585",result:"shape"})),e.reactExports.createElement("linearGradient",{id:"paint0_linear_273_3585",x1:1.16663,y1:1.00002,x2:66.9287,y2:50.6722,gradientUnits:"userSpaceOnUse"},e.reactExports.createElement("stop",{stopColor:"white",stopOpacity:.25}),e.reactExports.createElement("stop",{offset:1,stopColor:"white",stopOpacity:0})))),J="_avatar_1h7if_13",K="_image_1h7if_26",w={avatar:J,image:K},Q=({link:t})=>t?e.jsx("div",{className:w.avatar,children:e.jsx("img",{className:w.image,src:L(t)})}):e.jsx("div",{className:w.avatar,children:e.jsx(v.Icon,{icon:e.jsx(Z,{}),size:120})}),W="_page_ilwdz_13",X="_content_ilwdz_22",Y="_userName_ilwdz_31",ee="_links_ilwdz_36",te="_linkItem_ilwdz_40",se="_buttons_ilwdz_44",j={page:W,content:X,userName:Y,links:ee,linkItem:te,buttons:se},ue=({viewer:t})=>{const{isOpen:u,close:n,open:a,setState:s}=v.useDialog(),{isOpen:o,close:i,open:l,setState:c}=v.useDialog(),{isOpen:x,close:m,open:r,setState:E}=v.useDialog(),p=e.useControllers(),h=e.reactExports.useCallback(f=>p.viewer.editUser({values:f,onSuccess:()=>{n()},onError:()=>alert("Cannot update user")}),[n,p.viewer]),S=e.reactExports.useCallback(f=>p.viewer.editAvatar({values:f,onSuccess:()=>{m()},onError:()=>alert("Cannot update avatar")}),[m,p.viewer]),I=e.reactExports.useCallback(f=>p.viewer.editPassword({values:f,onSuccess:()=>{i()},onError:()=>alert("Cannot update password")}),[i,p.viewer]);return e.jsxs("div",{className:j.page,children:[u&&e.jsx(M,{viewer:t,isOpen:u,onSubmit:h,onOpenChange:s}),o&&e.jsx(T,{isOpen:o,onSubmit:I,onOpenChange:c}),x&&e.jsx(D,{isOpen:x,onSubmit:S,onOpenChange:E}),e.jsxs("div",{className:j.content,children:[e.jsx(Q,{link:t.avatar}),e.jsx("h4",{className:j.userName,children:t.display_name?t.display_name:`${t.first_name} ${t.second_name}`}),e.jsx(H,{...t}),e.jsxs("div",{className:j.buttons,children:[e.jsx(e.Button,{onClick:a,children:"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435"}),e.jsx(e.Button,{onClick:l,children:"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u043F\u0430\u0440\u043E\u043B\u044C"}),e.jsx(e.Button,{onClick:r,children:"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0430\u0432\u0430\u0442\u0430\u0440"})]})]})]})},ae="_page_enr3c_1",re={page:ae},le=()=>e.jsx("div",{className:re.page,children:"wow"}),ne="_page_prram_13",B={page:ne},oe=()=>{document.title="\u041F\u0440\u043E\u0444\u0438\u043B\u044C";const t=e.useAppSelector(u=>u.userReducer.user);return t?e.jsx("div",{className:B.page,children:e.jsx(ue,{viewer:t})}):e.jsx("div",{className:B.page,children:e.jsx(le,{})})};exports.default=oe;
